<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700"><rect x="0" y="0" width="1200" height="700" fill="#f7f7fb"/><defs>  <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="8" markerHeight="8" orient="auto">    <path d="M 0 0 L 10 5 L 0 10 z" fill="#333"/>  </marker></defs><rect x="80" y="80" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="110" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">1. Scan — Query attachments (apply skip rules)</text><line x1="600" y1="130" x2="600" y2="160" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="160" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="190" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">2. Convert — Original→WebP at quality; regenerate sizes</text><line x1="600" y1="210" x2="600" y2="240" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="240" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="270" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">3. Build Map — Old→New for original + sizes + path variants</text><line x1="600" y1="290" x2="600" y2="320" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="320" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="350" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">4. Rewrite DB — posts, postmeta (serialized), options (serialized)</text><line x1="600" y1="370" x2="600" y2="400" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="400" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="430" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">5. Update Metadata — file, metadata, mime, guid</text><line x1="600" y1="450" x2="600" y2="480" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="480" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="510" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">6. Backup/Delete — validation ON: move; OFF: delete</text><line x1="600" y1="530" x2="600" y2="560" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="560" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="590" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">7. Report — persist per-attachment changes</text><line x1="600" y1="610" x2="600" y2="640" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><rect x="80" y="640" width="1040" height="50" rx="8" ry="8" fill="#fff" stroke="#333" stroke-width="2"/><text x="100" y="670" font-family="Inter,Arial,Helvetica,sans-serif" font-size="16" text-anchor="start" font-weight="normal">8. Commit — delete backups; mark committed</text></svg>